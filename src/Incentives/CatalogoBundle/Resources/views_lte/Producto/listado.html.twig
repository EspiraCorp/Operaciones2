{# src/Sinaptica/ProveedoresBundle/Resources/views/Default/new.html.twig #}
{% extends '::baseLte.html.twig' %}

{% block title %}{{ parent() }}::Productos Catálogo{% endblock %}
{% block sectiontitle %}<h1>Catálogo<small>Productos Listado</small></h1>{% endblock %}
{% block breadcum %} <li><a href=""><i class="fa fa-hand-o-right"></i>Productos</a></li><li class="active"></li>{% endblock %}

{% block sidebar %}
{{ parent() }}
{% endblock %}

{% block content %}
  <div class="row">
        <div class="col-xs-12">
          <div class="box box-primary">
        		<div class="box-header">
        			<h2>Productos Catalogo</h2>
              
              <div class="box-tools pull-right"> 
                      <a href="{{ path('producto_editar_mas') }}" title="Edicion Masiva" class="btn btn-primary"><i class="fa fa-edit"></i></a>
                      <a href="{{ path('producto_importar') }}" title="Carga Masiva" class="btn btn-info"><i class="fa fa-upload"></i></a>
                      <a href="{{ path('producto_exportar') }}" title="Descargar" class="btn btn-info"><i class="fa fa-download"></i></a>
                      <a href="{{ path('producto_nuevo') }}" class="btn btn-success" title="Agregar"><i class="fa fa-plus"></i></a>
              </div>
        		</div>
        		<div class="box-body">
              <div id="example1_wrapper" class="dataTables_wrapper form-inline dt-bootstrap">
                <div class="row">
                  <div class="col-sm-12">
                    <table class="table table-bordered table-striped dataTable" id="productos" role="grid">
                        <thead>
                            {{ form_start(form, { attr: {novalidate: 'novalidate'} }) }}
                            <form action="{{ path('proveedores') }}" method="POST" class="form-horizontal">
                              <tr>
                                <th class="sorting" tabindex="0" rowspan="1" colspan="1">{{ knp_pagination_sortable(productos, 'Id', 'p.id') }}</th>
                                <th class="sorting" tabindex="0" rowspan="1" colspan="1">{{ knp_pagination_sortable(productos, 'Nombre', 'p.nombre') }}</th>
                                <th class="sorting" tabindex="0" rowspan="1" colspan="1">{{ knp_pagination_sortable(productos, 'Categoria', 'c.nombre') }}</th>
                                <th class="sorting" tabindex="0" rowspan="1" colspan="1">{{ knp_pagination_sortable(productos, 'Referencia', 'p.referencia') }}</th>
                                <th class="sorting" tabindex="0" rowspan="1" colspan="1">{{ knp_pagination_sortable(productos, 'Marca', 'p.marca') }}</th>
                                <th class="sorting" tabindex="0" rowspan="1" colspan="1">{{ knp_pagination_sortable(productos, 'EAN', 'p.codEAN') }}</th>
                                <th class="sorting" tabindex="0" rowspan="1" colspan="1">{{ knp_pagination_sortable(productos, 'SKU', 'p.codInc') }}</th>
                                <th class="sorting" tabindex="0" rowspan="1" colspan="1">{{ knp_pagination_sortable(productos, 'Precio', 'pp.precio') }}</th>
                                <th class="sorting" tabindex="0" rowspan="1" colspan="1">Catalogos</th>
                                <th class="sorting" tabindex="0" rowspan="1" colspan="1">{{ knp_pagination_sortable(productos, 'Estado', 'e.nombre') }}</th>
                                <th></th>
                              </tr>
                              <tr>
                                <th><input type="text" id="producto_id" name="producto[id]" style="width: 40px" value="{%if filtros.id is defined %}{{ filtros.id }}{% endif %}"></th>
                                <th>{{ form_widget(form.nombre, { 'attr': { 'style' : 'width:150px' }, 'value': filtros.nombre | default("") } ) }}</th>
                                <th>{{ form_widget(form.categoria, { 'attr': { 'style' : 'width:150px' }, 'value': filtros.categoria | default("") } ) }}</th>
                                <th>{{ form_widget(form.referencia, { 'attr': { 'style' : 'width:150px' }, 'value': filtros.referencia | default("") } ) }}</th>
                                <th>{{ form_widget(form.marca, { 'attr': { 'style' : 'width:100px' }, 'value': filtros.marca | default("") } ) }}</th>
                                <th>{{ form_widget(form.codEAN, { 'attr': { 'style' : 'width:100px' }, 'value': filtros.codEAN | default("") } ) }}</th>
                                <th>{{ form_widget(form.codInc, { 'attr': { 'style' : 'width:100px' }, 'value': filtros.codInc | default("") } ) }}</th>
                                <th style="width: 300px">Min<input type="text" id="precio_min" name="producto[precio_min]" style="width: 60px" value="{%if filtros.precio_min is defined %}{{ filtros.precio_min }}{% endif %}">
                                      Max<input type="text" id="precio_max" name="producto[precio_max]" style="width: 60px" value="{%if filtros.precio_max is defined %}{{ filtros.precio_max }}{% endif %}"></th>
                                <th></th>
                                <th>{{ form_widget(form.estado, { 'attr': { 'style' : 'width:80px' }, 'value': filtros.estado | default(1) } ) }}</th>
                                <th>{{ form_widget(form.Enviar, { 'attr': {'class': 'btn btn-primary'} }) }}</th>
                              </tr>
                            </thead>
                          </form>
                                <tbody>
                                  {% for producto in productos %}
                                    <tr role="row">
          			                      <td>{{ producto.producto.id }}</td>
                                      <td><a href="{{ path("producto_datos", {"id": producto.producto.id}) }}">{{ producto.producto.nombre }}</a></td>
                                      <td>{% if (producto.producto.categoria) %}{{ producto.producto.categoria.nombre }}{% endif %}</td>
                                      <td>{{ producto.producto.referencia }}</td>
                                      <td>{{ producto.producto.marca }}</td>
                                      <td>{{ producto.producto.codEAN }}</td>
                                      <td>{{ producto.producto.codInc }}</td>
                                      <td>{% if producto.producto.productoprecio %}{{ producto.producto.productoprecio[0].precio|number_format(0, ',', '.') }}{% endif %}</td>
                                      <td><div data-toggle="tooltip">{{ producto.producto.productocatalogo|length }}</div></td>
                                      <td>
                                        {% if (producto.producto.estado) %}
                                          {% if (producto.producto.estado.id!=1) %}<a class="btn btn-danger 1" onClick="confirmar('{{ url("producto_estado", {"id": producto.producto.id}) }}')" href="#">Inactivo</a>
                                          {% else %}<a class="btn btn-success 1" onClick="confirmar('{{ url("producto_estado", {"id": producto.producto.id}) }}')" href="#">Activo</a>
                                          {% endif %}
                                        {% endif %}
                                      </td>
                                    </tr>
                                  {% endfor %}
                                </tbody>
                              </table>
                </div>   
              </div>
        		</div>

        		<div class="box span11">
                <div class="box-content">
                        <div class="dataTables_info">Mostrando {{ productos.getItemNumberPerPage*(productos.getCurrentPageNumber-1)+1  }} a {{ productos.getItemNumberPerPage*productos.getCurrentPageNumber }} de {{ productos.getTotalItemCount }}   Productos
                        </div>
                        <div class="pagination pagination-centered">
                                {{ knp_pagination_render(productos) }}                    
                        </div>
                </div>
            </div>
        </div>
  	</div>
  </div>
{% endblock %}

{% block javascripts %}

{{ parent() }}

  <script type="text/javascript">
  
      function confirmar(ruta)
      {
        if (confirm("Desea cambiar el estado del producto")==true){
            self.location=ruta;
        }else{
            alert("OK");
        }
        
      }
 
    $(document).ready(function(){
        $('[data-toggle="tooltip"]').tooltip();   
    });
</script>

{% endblock %}

{% block stylesheet %}
  {{ parent() }}
  <style>
    body {
        width: 130%;
    }
  </style>

{% endblock %}

